# SonarQube Configuration for NestJS + Expo + tRPC Mono Repo
# Place this in the root of your mono repo

# ============================================
# PROJECT IDENTIFICATION
# ============================================
sonar.projectKey=be-full-stack-boilerplate
sonar.projectName=be-full-stack-boilerplate
sonar.projectVersion=1.0.0

# ============================================
# SOURCE CODE STRUCTURE
# ============================================
# Scan the entire monorepo: apps and packages
sonar.sources=apps,packages
# Note: Don't set sonar.tests to avoid files being indexed twice
# Test files are detected automatically by SonarQube

# ============================================
# EXCLUSIONS (adjust based on your structure)
# ============================================
sonar.exclusions=\
  **/node_modules/**,\
  **/dist/**,\
  **/build/**,\
  **/.next/**,\
  **/.expo/**,\
  **/coverage/**,\
  **/.git/**,\
  **/.docker/**,\
  **/.venv/**,\
  **/venv/**,\
  **/__pycache__/**,\
  **/*.min.js,\
  **/vendor/**,\
  **/tmp/**,\
  **/temp/**,\
  **/.cache/**

# Exclude specific directories per package
# sonar.exclusions=apps/web/dist/**,apps/api/dist/**,packages/*/dist/**

# ============================================
# TYPESCRIPT/JAVASCRIPT CONFIGURATION
# ============================================
# Separate JS and TS file suffixes to avoid conflicts
sonar.javascript.file.suffixes=.js,.jsx,.mjs,.cjs
sonar.typescript.file.suffixes=.ts,.tsx,.cts,.mts
sonar.typescript.tslint.configPath=./tsconfig.json

# Test coverage - adjust paths based on your coverage output
sonar.javascript.lcov.reportPaths=coverage/lcov.info

# Exclude test files from main coverage
sonar.coverage.exclusions=\
  **/*.test.ts,\
  **/*.test.tsx,\
  **/*.spec.ts,\
  **/*.spec.tsx,\
  **/tests/**,\
  **/__tests__/**,\
  **/test/**

# Code duplication exclusions
sonar.cpd.exclusions=\
  **/tests/**,\
  **/*.test.ts,\
  **/*.spec.ts,\
  **/node_modules/**,\
  **/dist/**,\
  **/build/**

# ============================================
# NESTJS SPECIFIC SETTINGS
# ============================================
# For NestJS API/Backend modules in apps/api or packages/api
# sonar.sources=apps/api/src,packages/api/src,apps/backend/src
# sonar.tests=apps/api/src,packages/api/src,apps/backend/src
# sonar.javascript.lcov.reportPaths=apps/api/coverage/lcov.info,packages/api/coverage/lcov.info

# ============================================
# REACT NATIVE / EXPO SETTINGS
# ============================================
# For Expo/React Native modules in apps/mobile or packages/mobile
# Configure React Native/Expo specific rules
# sonar.sources=apps/mobile/src,packages/mobile/src
# sonar.javascript.lcov.reportPaths=apps/mobile/coverage/lcov.info

# ============================================
# tRPC SETTINGS
# ============================================
# For tRPC server/client modules
# Usually part of NestJS or standalone packages
# sonar.sources=packages/trpc/src,apps/trpc/src

# ============================================
# ENCODING
# ============================================
sonar.sourceEncoding=UTF-8

# ============================================
# TIMEOUT & PERFORMANCE
# ============================================
sonar.ws.timeout=300

# ============================================
# IMPORTANT QUALITY GATES (Optional)
# ============================================
# These can be set via SonarQube UI, but documented here for reference

# Security hotspots to review manually
# sonar.security.hotspots.review.rating.stop=MEDIUM

# Minimum code coverage (%)
# sonar.coverage.exclusions=**/tests/**
# sonar.genericcoverage.unitTestReportPaths=coverage/test-report.xml

# ============================================
# ADVANCED: MULTI-MODULE SETUP (if needed)
# ============================================
# Uncomment and customize if your mono repo has these modules:

# Backend modules (NestJS, tRPC servers)
# sonar.sources=apps/api/src,apps/backend/src,packages/server/src,packages/trpc-server/src

# Frontend modules (React, Next.js)
# sonar.sources=apps/web/src,apps/dashboard/src,packages/ui/src

# Mobile modules (Expo, React Native)
# sonar.sources=apps/mobile/src,packages/mobile/src

# Library/Shared modules
# sonar.sources=packages/shared/src,packages/types/src,packages/utils/src,packages/ui/src

# Combined (all modules)
# sonar.sources=apps/*/src,packages/*/src

# ============================================
# COVERAGE REPORTS
# ============================================
# Generate coverage for each workspace and list them:
# For monorepo with multiple packages:
# sonar.javascript.lcov.reportPaths=apps/api/coverage/lcov.info,apps/web/coverage/lcov.info,apps/mobile/coverage/lcov.info,packages/shared/coverage/lcov.info

# Single coverage file:
# sonar.javascript.lcov.reportPaths=coverage/lcov.info
